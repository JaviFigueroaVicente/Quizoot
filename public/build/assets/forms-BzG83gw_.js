import{r as n,V as y}from"./app-Cmxi_hcm.js";function P(){const i=n([]),r=n({name:"",description:"",thumbnail:"",category_id:[]}),c=n([]),l=n([]),t=y("$swal"),s=n(!1),u=async(e=null)=>{s.value=!0;let a="/api/formulario";e&&(a+=`?category_id=${e}`),axios.get(a,{headers:{"content-type":"multipart/form-data"}}).then(o=>{i.value=o.data.data}).catch(o=>{console.log(o)}).finally(()=>{s.value=!1})},m=async()=>{axios.get("/api/formulario-user").then(e=>{i.value=e.data.data})},g=async e=>{s.value=!0,axios.get("/api/formulario/"+e).then(a=>{r.value=a.data}).catch(a=>{console.log(a)}).finally(()=>{s.value=!1})},d=async e=>{axios.get("/api/asignar-preguntas/"+e).then(a=>{l.value=a.data.data}).catch(a=>{console.log(a)})},f=async e=>{s.value=!0,axios.get("/api/preguntas-form/"+e).then(a=>{l.value=a.data.data}).catch(a=>{console.log(a)}).finally(()=>{s.value=!1})},w=async e=>{s.value=!0,axios.get("/api/ranking/"+e).then(a=>{c.value=a.data.data}).catch(a=>{console.log(a)}).finally(()=>{s.value=!1})},h=async(e,a)=>{const o=e.id;return!!(await axios.post("/api/verificar-respuesta",{pregunta_id:o,respuesta:a})).data.es_correcta},C=async()=>{try{const a=(await axios.post("/api/formulario",r.value,{headers:{"Content-Type":"multipart/form-data"}})).data.data.id;await p(a),t({icon:"success",title:"Formulario creado correctamente",showConfirmButton:!1,timer:1500,allowOutsideClick:!1,customClass:{popup:"swal"}})}catch(e){console.error("Error al crear el formulario:",e),t({icon:"error",title:"Error al crear el formulario",showConfirmButton:!0,allowOutsideClick:!1,customClass:{popup:"swal"}})}},p=async e=>{try{const a=await axios.post("/api/asignar-categorias/"+e,{category_ids:r.value.category_id});t({icon:"success",title:"Categorías asignadas correctamente",showConfirmButton:!1,timer:1500,allowOutsideClick:!1,customClass:{popup:"swal"}}),console.log(a)}catch(a){console.error(a),t({icon:"error",title:"Error al asignar categorías",showConfirmButton:!0,allowOutsideClick:!1,customClass:{popup:"swal"}})}};return{formularios:i,formulario:r,selectedPreguntas:l,ranking:c,isLoading:s,getForms:u,getUserForms:m,getForm:g,getFormPreguntas:d,getPreguntasSinRespuesta:f,getRankingFormulario:w,verificarRespuesta:h,storeForm:C,asignarPreguntas:async()=>{const e=r.value.id,a=[];for(let o=0;o<l.value.length;o++)a.push(l.value[o].id);try{const o=axios.post("/api/asignar-preguntas/"+e,{pregunta_ids:a});t({icon:"success",title:"Preguntas asignadas correctamente",showConfirmButton:!1,timer:1500,allowOutsideClick:!1,customClass:{popup:"swal"}}),console.log(o)}catch(o){console.log(o)}},updateForm:async e=>{axios.post("/api/formulario/"+e.id,e,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{t({icon:"success",title:"Form updated successfully",showConfirmButton:!1,timer:1500,allowOutsideClick:!1,customClass:{popup:"swal"}})}).catch(a=>{console.log(e),t({icon:"error",title:"Error al actualizar el formulario",showConfirmButton:!0,allowOutsideClick:!1,customClass:{popup:"swal"}})})},deleteForm:async e=>{t({title:"Are you sure?",text:"You won't be able to revert this action!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",confirmButtonColor:"#ef4444",timer:2e4,timerProgressBar:!0,reverseButtons:!0,allowOutsideClick:!1}).then(a=>{a.isConfirmed&&axios.delete("/api/formulario/"+e).then(o=>{u(),t({icon:"success",title:"Form deleted successfully",showConfirmButton:!1,timer:1500,allowOutsideClick:!1,customClass:{popup:"swal"}})}).catch(o=>{t({icon:"error",title:"Something went wrong",customClass:{popup:"swal"}})})})},asignarCategorias:p,getFormCategories:async e=>{try{return(await axios.get(`/api/formularios/${e}/categorias`)).data.data.map(o=>o.id)}catch(a){return console.error("Error al obtener categorías del formulario:",a),[]}}}}export{P as u};
