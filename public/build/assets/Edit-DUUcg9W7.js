import{p as T,r as f,J as $,a as M,d as u,i as e,q as b,k,b as x,l as g,e as y,R as h,t as z,F as A,y as O,V as G,h as m,m as J}from"./app-Cmxi_hcm.js";import{s as H,c as K,a as _,V as Q}from"./index.esm-BhpYNWYs.js";import{e as W}from"./yup-locales.esm-CWkDNdp4.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"main-container"},Z={class:"left-container card"},aa={class:"border-0 card-body card-main"},ea={class:"image-container"},ta={class:"flex flex-wrap justify-content-between align-items-center flex-1 gap-2"},sa={class:"flex gap-2"},oa=["alt","src"],la={key:1},na=["alt","src"],ra=["src"],ia={key:1,src:"/images/Nav/PerfilSinFoto.webp",alt:"Avatar Default",class:"object-fit-cover profile-image"},ua={class:"right-container card"},ma={class:"border-0 card-main card-body"},ca={class:"card-body"},da={class:"mb-3 input-form"},va={key:0,class:"text-danger"},pa={class:"mb-3 input-form"},fa={key:0,class:"text-danger"},ba={class:"mb-3 input-form"},ga={class:"mb-3 input-form"},ya={class:"mb-3 input-form"},ha={__name:"Edit",setup(_a){H(W);const B=M(),w=O(),c=T(),v=f({}),E=G("$swal"),I=K().shape({alias:_().required("Alias es un campo requerido"),name:_().required("Name es un campo requerido").min(3,"Name debe tener al menos 3 caracteres"),surname1:_(),surname2:_(),email:_().required("Email es un campo requerido").email("Email no valido")}),t=f({alias:"",name:"",surname1:"",surname2:"",email:""}),r=f(null),F=async()=>{axios.put("/api/user/"+c.user.id,t.value).then(s=>{E({icon:"success",title:"Usuario actualizado",showConfirmButton:!1,timer:1500}),t.value=s.data.data,w.push("/profile")}).catch(()=>{E({icon:"error",title:"Error al actualizar el usuario",showConfirmButton:!1,timer:1500})})},L=async()=>{const s=new FormData;s.append("users",r.value);const a=URL.createObjectURL(r.value);t.value.avatar=a,axios.post("/api/user/updateimg/"+c.user.id,s).then(n=>{if(E({icon:"success",title:"Imagen actualizada",showConfirmButton:!1,timer:1500}),n.data&&n.data.media&&n.data.media.length>0){const i=n.data.media[0].original_url;t.value.avatar=i,c.user&&(c.user.thumbnail=i,c.user.avatar=i)}}).catch(n=>{console.error("Error al actualizar la imagen:",n),toast.add({severity:"error",summary:"Error",detail:"Error al actualizar la imagen",life:3e3}),axios.get("/api/users/"+c.user.id).then(i=>{i.data&&i.data.data&&(t.value.avatar=i.data.data.avatar)})})},R=()=>{try{I.validateSync(t.value,{abortEarly:!1}),F()}catch(s){s instanceof Q?(v.value={},s.inner.forEach(a=>{v.value[a.path]=a.message})):console.error(s)}},j=()=>{console.log(r.value),r.value?(L(),w.push({name:"profile.index"})):E({icon:"error",title:"Error al actualizar la imagen",showConfirmButton:!1,timer:1500})};$(()=>{console.log(B.params.id),axios.get("/api/users/"+c.user.id).then(s=>{t.value=s.data.data})});const C=f(0),S=f(0),D=s=>{s.formData.append("id",user.id)},q=async(s,a)=>{console.log("uploadEvent"),S.value=C.value/10,await s()},N=s=>{if(s.files.length===0){r.value=null;return}const a=s.files[0];r.value=a,C.value=a.size,S.value=a.size/15e5*100,console.log("Archivo asignado a imagenFile:",r.value)};return(s,a)=>{const n=x("Button"),i=x("FileUpload"),P=x("Toast");return m(),u(A,null,[e("div",Y,[e("div",Z,[e("div",aa,[a[8]||(a[8]=e("div",{class:"card-header bg-transparent mt-3 mb-3"},[e("h5",{class:"float-start titles"},"PROFILE IMAGE")],-1)),e("div",ea,[b(i,{name:"picture",onBeforeUpload:D,onUpload:a[0]||(a[0]=o=>s.onTemplatedUpload(o)),accept:"image/*",maxFileSize:15e5,onSelect:N,"pt:content:class":"fu-content","pt:buttonbar:class":"fu-header","pt:root:class":"fu",class:"fu",modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value=o)},{header:k(({chooseCallback:o,uploadCallback:l,clearCallback:V,files:p,uploadedFiles:d})=>[e("div",ta,[e("div",sa,[b(n,{class:"boton",onClick:U=>o(),icon:"pi pi-images",rounded:"",outlined:""},null,8,["onClick"]),b(n,{class:"boton",onClick:U=>q(l,d),icon:"pi pi-cloud-upload",rounded:"",outlined:"",severity:"success",disabled:!p||p.length===0},null,8,["onClick","disabled"]),b(n,{class:"boton",onClick:U=>V(),icon:"pi pi-times",rounded:"",outlined:"",severity:"danger",disabled:!p||p.length===0},null,8,["onClick","disabled"])]),a[7]||(a[7]=e("p",{class:"mt-4 mb-0"},"Arrastra y suelta la imagen aquÃ­.",-1))])]),content:k(({files:o,uploadedFiles:l,removeUploadedFileCallback:V,removeFileCallback:p})=>[o.length>0?(m(!0),u(A,{key:0},J(o,(d,U)=>(m(),u("img",{key:d.name+d.type+d.size,role:"presentation",alt:d.name,src:d.objectURL,class:"object-fit-cover profile-image mt-3"},null,8,oa))),128)):(m(),u("div",la,[l.length>0?(m(),u("img",{key:l[l.length-1].name+l[l.length-1].type+l[l.length-1].size,role:"presentation",alt:l[l.length-1].name,src:l[l.length-1].objectURL,class:"object-fit-cover w-100 h-100 profile-image"},null,8,na)):y("",!0)]))]),empty:k(()=>[t.value.avatar?(m(),u("img",{key:0,src:t.value.avatar,alt:"Avatar",class:"object-fit-cover profile-image"},null,8,ra)):y("",!0),t.value.avatar?y("",!0):(m(),u("img",ia))]),_:1},8,["modelValue"])])]),e("button",{type:"submit",onClick:j,class:"btn-custom w-100 mt-5"}," UPDATE IMAGE ")]),e("div",ua,[e("div",ma,[a[14]||(a[14]=e("div",{class:"card-header bg-transparent mt-3 mb-3"},[e("h5",{class:"float-start titles"},"PROFILE DETAILS")],-1)),e("div",ca,[e("div",da,[g(e("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=o=>t.value.alias=o),class:"form-control",id:"alias"},null,512),[[h,t.value.alias]]),a[9]||(a[9]=e("label",{for:"alias",class:"form-label"},"Alias",-1)),v.value.alias?(m(),u("small",va,z(v.value.alias)+">",1)):y("",!0)]),e("div",pa,[g(e("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=o=>t.value.name=o),class:"form-control",id:"name"},null,512),[[h,t.value.name]]),a[10]||(a[10]=e("label",{for:"name",class:"form-label"},"Name",-1)),v.value.name?(m(),u("small",fa,z(v.value.name)+">",1)):y("",!0)]),e("div",ba,[g(e("input",{type:"text","onUpdate:modelValue":a[4]||(a[4]=o=>t.value.surname1=o),class:"form-control",id:"surname1"},null,512),[[h,t.value.surname1]]),a[11]||(a[11]=e("label",{for:"surname1",class:"form-label"},"First Surname",-1))]),e("div",ga,[g(e("input",{type:"text","onUpdate:modelValue":a[5]||(a[5]=o=>t.value.surname2=o),class:"form-control",id:"surname2"},null,512),[[h,t.value.surname2]]),a[12]||(a[12]=e("label",{for:"surname2",class:"form-label"},"Second Surname",-1))]),e("div",ya,[g(e("input",{type:"email","onUpdate:modelValue":a[6]||(a[6]=o=>t.value.email=o),class:"form-control",id:"email",readonly:""},null,512),[[h,t.value.email]]),a[13]||(a[13]=e("label",{for:"email",class:"form-label"},"Email",-1))])])]),e("button",{type:"submit",onClick:R,class:"btn-custom w-100 mt-5"}," UPDATE PROFILE ")])]),b(P)],64)}}},wa=X(ha,[["__scopeId","data-v-01198278"]]);export{wa as default};
