import{r as C,J as E,y as B,d as U,i as a,q as t,k as s,f as c,X as V,b as r,H as $,F as D,W as G,V as M,h as K,K as p}from"./app-Cmxi_hcm.js";import{u as O}from"./preguntas-wEJ3Kd-z.js";import{u as z}from"./forms-BzG83gw_.js";import{c as L,b as j,d as q,V as H}from"./index.esm-BhpYNWYs.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"grid"},X={class:"col-6"},Q={class:"card"},Y={class:"search-and-filters-container flex md:flex-row"},Z={class:"icon-field-container flex align-items-center"},ee={class:"buttons-container flex gap-2 ml-2"},te={class:"col-6"},ae={class:"card"},se={class:"card-header bg-transparent ps-0 pe-0 mb-5"},ne={class:"button-asignar flex flex-column align-items-center"},oe={__name:"AsignarPreguntas",setup(le){const y=M("$swal"),m=C({}),f=B(),{preguntas:x,getUserPreguntas:g}=O(),{getForm:A,getFormPreguntas:I,selectedPreguntas:o,asignarPreguntas:N}=z(),u=C(),P=L().shape({pregunta_ids:j().of(q()).min(1,"Debe seleccionar al menos una pregunta")});E(()=>{g(),A(f.currentRoute.value.params.id),I(f.currentRoute.value.params.id)});const b=()=>{u.value={global:{value:null,matchMode:G.CONTAINS}}};b();const h=l=>{o.value=o.value.filter(e=>e.id!==l.id)},R=()=>{o.value=[]},k=async()=>{try{await P.validate({pregunta_ids:o.value.map(l=>l.id)},{abortEarly:!1}),await N(),f.push({name:"mis-formularios.index"})}catch(l){l instanceof H?(m.value={},l.inner.forEach(e=>{m.value[e.path]=e.message})):console.error(l),y({icon:"error",title:m.value.pregunta_ids,showConfirmButton:!0,allowOutsideClick:!1})}};return(l,e)=>{const w=r("InputIcon"),F=r("InputText"),S=r("IconField"),d=r("Button"),v=r("router-link"),T=r("Toolbar"),i=r("Column"),_=r("DataTable");return K(),U(D,null,[e[13]||(e[13]=a("h1",null,"ASIGNAR PREGUNTAS",-1)),a("div",W,[a("div",X,[a("div",Q,[e[7]||(e[7]=a("div",{class:"card-header bg-transparent ps-0 pe-0"},[a("h5",{class:"float-start mb-0"},"BUSCAR PREGUNTAS")],-1)),t(_,{filters:u.value,"onUpdate:filters":e[3]||(e[3]=n=>u.value=n),size:"normal",selection:c(o),"onUpdate:selection":e[4]||(e[4]=n=>V(o)?o.value=n:null),value:c(x).data,paginator:"",rows:5,globalFilterFields:["id","pregunta","created_at"],stripedRows:"",dataKey:"id",class:"datatable"},{header:s(()=>[t(T,{"pt:root:class":"toolbar-table"},{start:s(()=>[a("div",Y,[a("div",Z,[t(S,null,{default:s(()=>[t(w,{class:"pi pi-search"}),t(F,{modelValue:u.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=n=>u.value.global.value=n),placeholder:"Buscar"},null,8,["modelValue"])]),_:1})]),a("div",ee,[t(d,{type:"button",icon:"pi pi-filter-slash",label:"Clear",outlined:"",onClick:e[1]||(e[1]=n=>b())}),t(d,{type:"button",icon:"pi pi-refresh",outlined:"",onClick:e[2]||(e[2]=n=>c(g)())}),t(v,{to:{name:"mis-preguntas.create"},class:"flex align-items-center"},{default:s(()=>e[5]||(e[5]=[a("button",{type:"button",class:"btn btn-primary button button-action crear-pregunta"},"Crear pregunta",-1)])),_:1,__:[5]})])])]),_:1})]),empty:s(()=>e[6]||(e[6]=[p(" No hay preguntas. ")])),default:s(()=>[t(i,{selectionMode:"multiple",value:"preguntas.data",dataKey:"id"}),t(i,{field:"id",header:"ID",sortable:""}),t(i,{field:"pregunta",header:"Pregunta",sortable:""}),t(i,{field:"created_at",header:"Creado el",sortable:""})]),_:1},8,["filters","selection","value"])])]),a("div",te,[a("div",ae,[a("div",se,[e[9]||(e[9]=a("h5",{class:"float-start mb-0"},"PREGUNTAS SELECCIONADAS",-1)),t(d,{type:"button",class:"p-button-danger limpiar-button",onClick:R},{default:s(()=>e[8]||(e[8]=[p("Borrar todas")])),_:1,__:[8]})]),t(_,{size:"normal",value:c(o),paginator:"",rows:5,class:"datatable mt-5"},{loading:s(()=>e[10]||(e[10]=[p(" Cargando preguntas seleccionadas... ")])),empty:s(()=>e[11]||(e[11]=[p(" No hay preguntas seleccionadas ")])),default:s(()=>[t(i,null,{body:s(n=>[t(d,{icon:"pi pi-minus",class:"p-button-danger",onClick:re=>h(n.data)},null,8,["onClick"])]),_:1}),t(i,{field:"id",header:"ID"}),t(i,{field:"pregunta",header:"Pregunta"})]),_:1},8,["value"])])])]),a("div",ne,[a("button",{type:"submit",class:"btn btn-custom mt-2",onClick:$(k,["prevent"])},"ASIGNAR PREGUNTAS"),t(v,{to:{name:"mis-formularios.index"},class:"flex align-items-center"},{default:s(()=>e[12]||(e[12]=[a("button",{type:"button",class:"btn btn-cancelar mt-3"},"CANCELAR",-1)])),_:1,__:[12]})])],64)}}},me=J(oe,[["__scopeId","data-v-89aff754"]]);export{me as default};
